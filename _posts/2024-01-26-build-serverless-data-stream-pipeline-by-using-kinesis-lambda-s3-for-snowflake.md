---
layout: post
title: "X√¢y d·ª±ng serverless data stream pipeline b·∫±ng AWS Kinesis, Lambda, S3 cho Snowflake"
date: 2024-01-26 10:00:00 +0700
categories: Data-Pipeline
tags:
  - AWS
  - Kinesis Data Streams
  - Data Pipeline
  - Snowflake
hide_thumbnail: true
image: /assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/thumbnail.png

---

Trong b√†i vi·∫øt n√†y m√¨nh s·∫Ω chia s·∫ª v·ªÅ m·ªôt m√¥ h√¨nh m√† m√¨nh s·ª≠ d·ª•ng ƒë·ªÉ ƒë·ªÅ xu·∫•t kh√°ch h√†ng trong qu√° tr√¨nh th·ª±c hi·ªán estimate m·ªôt d·ª± √°n trong b·ªô ph·∫≠n, m√† tr√™n th·ª±c t·∫ø b·∫£n th√¢n c≈©ng ch∆∞a t·ª´ng s·ª≠ d·ª•ng (li·ªÅu ƒÉn nhi·ªÅu :meat_on_bone:) n√™n c√≥ th·ªÉ s·∫Ω ph√°t sinh kh√° nhi·ªÅu issue üòÇ.

Ban ƒë·∫ßu c√° nh√¢n m√¨nh c≈©ng r·∫•t mong mu·ªën ƒë∆∞·ª£c m·ªôt Data Engineer c√≥ nhi·ªÅu kinh nghi·ªám chinh chi·∫øn trong ngh·ªÅ gi√∫p s·ª©c, nh∆∞ng t√¨m ho√†i trong c√¥ng ty kh√¥ng c√≥ v·ªã tr√≠ n√†y v√† c≈©ng ch∆∞a th·∫•y c√≥ ai ƒë√£ t·ª´ng v·∫≠n h√†nh h·ªá th·ªëng ki·ªÉu n√†y cho kh√°ch, n√™n th√¥i t·ª± m√¨nh th·ª≠ implement coi sao ü´£, n·∫øu b·∫°n c≈©ng c√≥ kinh nghi·ªám v·ªõi c√°c h·ªá th·ªëng x√¢y d·ª±ng data pipeline ki·ªÉu n√†y, h√£y ƒë·ªÉ l·∫°i comment g√≥p √Ω nh√© üöÄ

## B·ªëi c·∫£nh

H·ªá th·ªëng c·ªßa kh√°ch h√†ng c√≥ 3 services ch√≠nh, ph·ª•c v·ª• end-user, m·ªói service l·∫°i s·ª≠ d·ª•ng c√°c 3rd-party kh√°c nhau ƒë·ªÉ thu th·∫≠p metrics nh·∫±m theo d√µi, ƒëo l∆∞·ªùng, ph√¢n t√≠ch h√†nh vi ng∆∞·ªùi s·ª≠ d·ª•ng.

M·ª•c ƒë√≠ch cu·ªëi c√πng l√† ƒë·ªÉ c√≥ nh·ªØng b·∫£n b√°o c√°o, ph√¢n t√≠ch, gi√∫p b·ªô ph·∫≠n Marketing c√≥ s·ª± ƒë√°nh gi√° ch√≠nh x√°c h∆°n v·ªÅ t√¨nh h√¨nh kinh doanh online v√† c√≥ c∆° s·ªü th·ª±c t·∫ø ƒë·ªÉ th·ª±c hi·ªán c√°c chi·∫øn d·ªãch Marketing, qu·∫£ng c√°o hi·ªáu qu·∫£ h∆°n.

![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/current-system.png)

H·ªá th·ªëng g·ªìm 3 services, v√† c√°c event logs ƒë∆∞·ª£c g·ª≠i t·ªõi nhi·ªÅu 3rd services ph·ª•c v·ª• cho vi·ªác l∆∞u tr·ªØ. C√°c event logs n√†y sau ƒë√≥ ƒë∆∞·ª£c bi·∫øn ƒë·ªïi c·∫•u tr√∫c v√† l∆∞u l·∫°i v√†o m·∫•y d·ªãch v·ª• OLAP (Online Analytical Processing) serverless query service ƒë·∫°i lo·∫°i nh∆∞ `GCP BigQuery`, `AWS Athena`.

D·ªØ li·ªáu t·ª´ c√°c OLAP services s·∫Ω ƒë∆∞·ª£c query v√† th·ª±c hi·ªán insert v√†o `AWS DynamoDB` b·ªüi m·ªôt *Batch Process* ƒë√£ ƒë∆∞·ª£c l·∫≠p l·ªãch.

ƒê·ªÉ qu·∫£n tr·ªã vi√™n c√≥ th·ªÉ d·ªÖ d√†ng ph√¢n t√≠ch s·ªë li·ªáu qua bi·ªÉu ƒë·ªì, ph√≠a kh√°ch h√†ng ƒë√£ build m·ªôt ·ª©ng d·ª•ng ri√™ng, qu·∫©y d·ªØ li·ªáu sau c√πng t·ª´ `AWS DynamoDB` v√† hi·ªÉn th·ªã cho qu·∫£n tr·ªã vi√™n, nh√¢n vi√™n b√°n h√†ng, ...

## V·∫•n ƒë·ªÅ

H·ªá th·ªëng tr√™n ƒëang t·ªìn t·∫°i m·ªôt s·ªë v·∫•n ƒë·ªÅ nh∆∞:

- ƒê·ªô tr·ªÖ trong vi·ªác hi·ªÉn th·ªã d·ªØ li·ªáu m·ªõi nh·∫•t, kh√¥ng ph√π h·ª£p ·ªü th·ªùi ƒëi·ªÉm c·∫ßn ph·∫£n h·ªìi nhanh.
- C·∫•u tr√∫c / Format d·ªØ li·ªáu kh√¥ng ƒë·ªìng nh·∫•t gi·ªØa c√°c services
- C·∫ßn nhi·ªÅu t√†i nguy√™n: th·ªùi gian x·ª≠ l√Ω, c·∫•u h√¨nh m√°y ch·ªß do d·ªØ li·ªáu ·ª© ƒë·ªçng l·ªõn
- G√°nh n·∫∑ng qu·∫£n tr·ªã h·ªá th·ªëng khi x·∫£y ra l·ªói m·ªôt th√†nh ph·∫ßn n√†o ƒë√≥ trong h·ªá th·ªëng

Tr∆∞·ªõc nh·ªØng v·∫•n ƒë·ªÅ ƒë√≥, kh√°ch h√†ng t√¨m t·ªõi ch√∫ng t√¥i mong mu·ªën c√≥ gi·∫£i ph√°p kh·∫Øc ph·ª•c hi·ªán tr·∫°ng n√†y. Nh∆∞ v·∫≠y c·∫ßn c·∫£i thi·ªán h·ªá th·ªëng ƒë·ªÉ kh·∫Øc ph·ª•c c√°c nh∆∞·ª£c ƒëi·ªÉm tr√™n.

![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/new-system.png)

## Gi·∫£i ph√°p

ƒê·ªÉ ti·∫øt ki·ªám ti·ªÅn cho kh√°ch, ƒë·ªôi d·ª± √°n ƒë·∫≠p to√†n b·ªô nh·ªØng ph·∫ßn c≈© ƒëi v√† x·∫≠y l·∫°i m·ªôt Data Stream Pipeline üòÜ

- **Th·ªùi Gian Th·ª±c (Real-time)**: Cho ph√©p x·ª≠ l√Ω d·ªØ li·ªáu ngay l·∫≠p t·ª©c khi n√≥ ƒë∆∞·ª£c t·∫°o ra,th√¥ng tin m·ªõi nh·∫•t s·∫Ω c√≥ s·∫µn ngay khi n√≥ xu·∫•t hi·ªán.
- **Kh·∫£ NƒÉng M·ªü R·ªông (Scalability)**: Th√≠ch ·ª©ng v·ªõi c√°c bi·∫øn ƒë·ªông trong kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu.
- **Ph·∫£n H·ªìi Nhanh (Quick Feedback)**: V·ªõi kh·∫£ nƒÉng x·ª≠ l√Ω d·ªØ li·ªáu ngay l·∫≠p t·ª©c, data stream pipeline cung c·∫•p ph·∫£n h·ªìi nhanh ch√≥ng, gi√∫p ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞a ra quy·∫øt ƒë·ªãnh d·ª±a tr√™n th√¥ng tin m·ªõi ngay khi n√≥ c√≥ s·∫µn.
- **X·ª≠ L√Ω D·ªØ Li·ªáu Li√™n t·ª•c (Continuous Data Processing)**: Kh√¥ng ch·ªù ƒë·∫øn khi c√≥ m·ªôt l√¥ d·ªØ li·ªáu ƒë·∫ßy ƒë·ªß nh∆∞ trong batch processing.
- **T√≠nh Linh Ho·∫°t (Flexibility)**: Data stream pipeline th∆∞·ªùng linh ho·∫°t h∆°n v·ªõi kh·∫£ nƒÉng x·ª≠ l√Ω d·ªØ li·ªáu ƒëa d·∫°ng t·ª´ nhi·ªÅu ngu·ªìn v√† ƒë·ªãnh d·∫°ng kh√°c nhau. Vi·ªác th√™m m·ªõi v√† c·∫≠p nh·∫≠t d·ªØ li·ªáu c√≥ th·ªÉ ƒë∆∞·ª£c th·ª±c hi·ªán d·ªÖ d√†ng h∆°n.
- **Ti·∫øt Ki·ªám T√†i Nguy√™n (Resource Efficiency)**: Do data stream pipeline th∆∞·ªùng ch·ªâ x·ª≠ l√Ω d·ªØ li·ªáu c·∫ßn thi·∫øt v√† kh√¥ng ƒë·ª£i ƒë·∫øn khi c√≥ l∆∞·ª£ng d·ªØ li·ªáu l·ªõn, n√≥ c√≥ th·ªÉ ti·∫øt ki·ªám t√†i nguy√™n so v·ªõi vi·ªác x·ª≠ l√Ω theo batch.

### Ki·∫øn tr√∫c Pipeline

![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/data-stream-pipeline-architect.png)

Trong ki·∫øn tr√∫c tr√™n th√¨ c√°c services l·∫ßn l∆∞·ª£t ƒë√≥ng vai tr√≤ nhi·ªám v·ª• sau:

- **AWS Kinesis Data Streams**: `Source Stream`
- **AWS Kinesis Data Firehose**: `Delivery Stream`
- **AWS Lambda**: `Transformer Function`
- **AWS S3**: `Data Lake`
- **Snowflake**: `Data Warehouse`

T·∫•t c·∫£ ƒë·ªÅu l√† **Fully Managed Services** gi√∫p gi·∫£m g√°nh n·∫∑ng qu·∫£n tr·ªã h·ªá th·ªëng cho ƒë·ªôi ng≈© k·ªπ s∆∞ h·∫° t·∫ßng b√™n kh√°ch.

#### Data Flow

- ‚ë† C√°c services hi·ªán t·∫°i s·∫Ω t√≠ch h·ª£p Kinesis Client v√† th·ª±c hi·ªán `PUT event` v√†o **Source Stream** (`AWS Kinesis Data Streams`).
- ‚ë° Sau ƒë√≥ event s·∫Ω ƒë∆∞·ª£c chuy·ªÉn t·ªõi **Delivery Stream** (`AWS Kinesis Data Firehose`)
  - ‚ë¢ T·∫°i ƒë√¢y event s·∫Ω ƒë∆∞·ª£c ph√¢n lo·∫°i, validate, transform th√¥ng qua **Transformer Function** (`Lambda Function`).
    - Trong tr∆∞·ªùng h·ª£p n√†y ch·ªâ ƒë∆°n thu·∫ßn l√† convert t·ª´ `JSON` dang `CSV` format ([*Loading data into Snowflake is fast and flexible. You get the greatest speed when working with CSV files*](https://www.snowflake.com/blog/how-to-load-terabytes-into-snowflake-speeds-feeds-and-techniques/))
- ‚ë£ D·ªØ li·ªáu sau x·ª≠ l√Ω s·∫Ω ƒëi v√†o **Data Lake** (`AWS S3`)
- ‚ë§ T·ª´ `AWS S3`, th√¥ng qua Snow Pipe Auto-ingestion, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë·ªìng b·ªô t·ªõi `Database > Table` tr√™n **Data Warehouse** (`Snowflake`)

#### Monitoring

... To be define :relieved:

## Proof of Concept

To√†n b·ªô code th·ª±c hi·ªán demo t·ª´ kh√¢u tri·ªÉn khai x√¢y d·ª±ng h·∫° t·∫ßng tr√™n AWS = CDK, C·∫•u h√¨nh Snowflake, Th·ª±c hi·ªán `PUT` **dummy Orders data** t·ªõi Source Stream ƒë·ªÅu ƒë√£ ƒë∆∞·ª£c public l√™n Github c√° nh√¢n m√¨nh:

‚≠ê üåü **[https://github.com/euclid1990/data-stream-pipeline](https://github.com/euclid1990/data-stream-pipeline)** :bell:

### 1. Chu·∫©n b·ªã t√†i kho·∫£n

- ƒêƒÉng k√Ω t√†i kho·∫£n **AWS**: [https://portal.aws.amazon.com/billing/signup](https://portal.aws.amazon.com/billing/signup)
- ƒêƒÉng k√Ω t√†i kho·∫£n **Snowflake**: [https://signup.snowflake.com](https://signup.snowflake.com)
  - Sau khi ho√†n t·∫•t ƒëƒÉng k√Ω b·∫°n s·∫Ω c√≥ 400$ credit / Trial trong 1 th√°ng
    ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-signup-bonus.png)

### 2. C·∫•u h√¨nh chung

Tr∆∞·ªõc h·∫øt ch√∫ng ta c·∫ßn c√≥ source code tr√™n m√°y

```bash
git clone git@github.com:euclid1990/data-stream-pipeline.git
cd data-stream-pipeline
```

Ch·ªânh s·ª≠a t·ªáp tin **.env**

```bash
$ cp .env.example .env
$ code .env

CDK_STACK="PipelineStack"   >>>  T√™n stack s·∫Ω t·∫°o tr√™n AWS
CDK_ACCOUNT="123456789012"  >>>  *AWS Account ID* c·ªßa b·∫°n / B·∫Øt bu·ªôc ch·ªânh s·ª≠a
CDK_REGION="us-east-1"      >>>  Region s·∫Ω th·ª±c hi·ªán deploy stack tr√™n
CDK_USER_NAME="cdk"         >>>  T√™n user name t·∫°o m·ªõi ƒë·ªÉ ch·∫°y CDK, t√°ch bi·ªát v·ªõi default account
CDK_ROLE_NAME="cdk-role"    >>>  Role m√† CDK_USER_NAME s·∫Ω assume ƒë·ªÉ c√≥ permission c·∫ßn thi·∫øt provision AWS resources
CDK_USER_POLICY_NAME="cdk-inline-policy"   >>>  T√™n user name t·∫°o m·ªõi ƒë·ªÉ ch·∫°y CDK, t√°ch bi·ªát v·ªõi default account
```

Th√™m quy·ªÅn execute cho to√†n b·ªô Bash script trong th∆∞ m·ª•c `/scripts`

```bash
chmod +x ./scripts/*/**/*.sh
```

### 3. T·∫°o AWS User/Role ch·∫°y CDK app

```bash
./scripts/create_iam_user_role.sh
```

### 4. Th·ª±c hi·ªán deploy AWS Stack

```bash
./scripts/cdk.sh deploy --outputs-file ./outputs.json
```

K·∫øt qu·∫£

![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/cdk-outputs.png)

To√†n b·ªô c√°c Outputs s·∫Ω ƒë∆∞·ª£c save ·ªü file `./outputs.json` ph·ª•c v·ª• cho vi·ªác setup **Snowflake** c≈©ng nh∆∞ **Produce event** t·ªõi **Kinesis Data Streams**

### 5. C·∫•u h√¨nh Snowflake Auto-ingest S3 Data

Chi ti·∫øt b∆∞·ªõc n√†y ƒë√£ ƒë∆∞·ª£c ph√≠a **Snowflake** h∆∞·ªõng d·∫´n r·∫•t k·ªπ t·∫°i ƒë√¢y

- [Refreshing External Tables Automatically for Amazon S3](https://docs.snowflake.com/en/user-guide/tables-external-s3)

M√¨nh ƒë√£ re-write l·∫°i c√°c step = **bash script** cho ti·ªán

- #### 5.1. Gi·ªõi h·∫°n quy·ªÅn truy c·∫≠p t·ªõi **AWS S3 Bucket** theo **VPC ID** c·ªßa Snowflake account

  - Truy v·∫•n th√¥ng tin **VPC ID** tr√™n **Snowflake** n∆°i ƒë·∫∑t t√†i kho·∫£n Snowflake c·ªßa b·∫°n tr√™n AWS
    - N·ªôi dung `SQL Query`: `./scripts/snowflake/01-allow-vpc-id/retrieve_snowflake_aws_vpc_id.sql`
    - K·∫øt qu·∫£
      ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-account-vpc-id.png)

  - Thi·∫øt l·∫≠p Bucket Policy t∆∞∆°ng ·ª©ng

    ```bash
    ./scripts/snowflake/01-allow-vpc-id/restrict_s3_access_to_vpc.sh <VPC_ID>
    ```

- #### 5.2. C·∫•u h√¨nh quy·ªÅn truy c·∫≠p t·ª´ **Snowflake** t·ªõi **AWS S3**

  - T·∫°o m·ªõi IAM Policy

    ```bash
    ./scripts/snowflake/02-aws-snowflake-s3-access-policy/create.sh
    ```

    ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-s3-access-policy.png)
  - T·∫°o m·ªõi IAM Role tr√™n AWS

    ```bash
    ./scripts/snowflake/03-aws-snowflake-iam-role/create.sh`
    ```

    Output c·ªßa vi·ªác th·ª±c thi script

    ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-query-instructions.png)

    K·∫øt qu·∫£ tr√™n **AWS IAM Roles**

    ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-role.png)

    ·ªû b∆∞·ªõc n√†y, to√†n b·ªô c√°c c√¢u **SQL** c·∫ßn d√πng ƒë·ªÉ th·ª±c thi trong c√°c step s·∫Øp t·ªõi ƒë√£ ƒë∆∞·ª£c generate th√†nh file **`./scripts/snowflake/03-aws-snowflake-iam-role/integration.sql`**.

    ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-auto-generated-sql.png)

    H√£y copy & paste sang ***SQL Worksheet*** tr√™n **Snowflake**.

    - T·∫°o Database **s3_to_snowflake**
    - T·∫°o S3 Storage Integration **s3_int**
    - Th·ª±c hi·ªán truy xu·∫•t ARN c·ªßa AWS IAM user ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông cho t√†i kho·∫£n Snowflake c·ªßa b·∫°n

      ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-desc-s3-integration.png)

      > - STORAGE_AWS_IAM_USER_ARN: AWS IAM user ƒë∆∞·ª£c t·∫°o cho t√†i kho·∫£n Snowflake c·ªßa b·∫°n. T·∫•t c·∫£ c√°c t√≠ch h·ª£p l∆∞u tr·ªØ S3 ƒë·ªÅu s·ª≠ d·ª•ng IAM user ƒë√≥.
      > - STORAGE_AWS_EXTERNAL_ID: External ID c·∫ßn thi·∫øt ƒë·ªÉ thi·∫øt l·∫≠p m·ªëi quan h·ªá tin c·∫≠y trust relationship.

    Th·ª±c thi theo c√°c b∆∞·ªõc h∆∞·ªõng d·∫´n t·ª´ Output c·ªßa script tr√™n.

    - Cho ph√©p Snowflake IAM User quy·ªÅn ƒë∆∞·ª£c truy c·∫≠p t·ªõi Bucket Objects

      ```bash
      ./scripts/snowflake/03-aws-snowflake-iam-role/update.sh <STORAGE_AWS_IAM_USER_ARN> <STORAGE_AWS_EXTERNAL_ID>
      ```

      K·∫øt qu·∫£ tr√™n AWS, **Trust relationships** ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t

      ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-role-trust-relationship.png)

- #### 5.3. L√†m m·ªõi d·ªØ li·ªáu c·ªßa external table v·ªõi Amazon SQS notifications cho S3 bucket

  - S·ª≠ d·ª•ng n·ªôi dung trong **`./scripts/snowflake/03-aws-snowflake-iam-role/integration.sql`** ƒë·ªÉ t·∫°o m·ªõi
    - **Stage**
    - **CSV Format**
    - **External Table**
  - Sau ƒë√≥ ch√∫ng ta c√≥ th·ªÉ truy xu·∫•t th√¥ng tin t·ªõi ARN c·ªßa SQS queue cho External table trong c·ªôt notification_channel
    ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-notification-channel.png)

  - Th·ª±c hi·ªán c·∫•u h√¨nh Event Notifications cho **S3 Bucket** v·ªõi gi√° tr·ªã c·ªôt **notification_channel**
    ```bash
    ./scripts/snowflake/04-aws-s3-event-notification/create.sh <notification_channel_arn>
    ```

    K·∫øt qu·∫£ tr√™n AWS, **S3 Event Notification** ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t

    ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/aws-s3-event-notification.png)

### 6. Ki·ªÉm tra vi·ªác Sync d·ªØ li·ªáu / Auto-ingest sang Snowflake

#### Before

- D·ªØ li·ªáu tr√™n **AWS S3** v√† **Snowflake** ƒë·ªÅu ch∆∞a c√≥ g√¨ üö´

  ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/aws-s3-bucket-empty.png)


  ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-table-empty.png)


#### After

- Th·ª±c hi·ªán stream 1,800 records t·ªõi **AWS Kinesis Data Streams**

```bash
./scripts/produce.sh 1800
```

![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/produce-1800-records-to-kinesis.png)

- D·ªØ li·ªáu xu·∫•t hi·ªán t·∫°i **S3 Desitnation Stream**

  ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/aws-s3-bucket-stream-data.png)

- D·ªØ li·ªáu ƒë∆∞·ª£c auto-ingest t·ªõi **Snowflake Table**

  Record ID = 1,800 ƒë√£ c√≥ m·∫∑t üòÜ

  ![](/assets/img/posts/2024-01-26-build-serverless-data-stream-pipeline-by-using-kinesis-lambda-s3-for-snowflake/snowflake-table-data.png)

üçÄ Nh∆∞ v·∫≠y ch√∫ng ta c√≥ th·ªÉ x√°c nh·∫≠n lu·ªìng d·ªØ li·ªáu ho·∫°t ƒë·ªông nh∆∞ mong ƒë·ª£i. Ki·ªÉm ch·ª©ng ƒë·ªÅ xu·∫•t c√≥ kh·∫£ nƒÉng hi·ªán th·ª±c ho√° üíØ

C·∫£m ∆°n b·∫°n ƒë√£ quan t√¢m t·ªõi t·∫≠n cu·ªëi b√†i vi·∫øt üöÄ
